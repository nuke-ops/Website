<!DOCTYPE html>
<html>

<head>
    <title>{{ stream.title }} Stream</title>
    <link href="https://vjs.zencdn.net/7.15.4/video-js.css" rel="stylesheet">
    <script src="https://vjs.zencdn.net/7.15.4/video.js"></script>
</head>

<body>
    {% if stream.authorization_required %}
    {% if user.is_authenticated %}
    <h2>Stream: {{ stream.title }}</h2>
    <video id="hlsPlayer" class="video-js vjs-default-skin" controls width="640" height="360">
        <source src="https://nukeops.com/media/protected/hls/{{ stream.title|urlencode }}.m3u8"
            type="application/x-mpegURL">
        Your browser does not support the video tag.
    </video>
    <script>
        var player = videojs('hlsPlayer', {
            techOrder: ['html5'],
            sources: [{ type: "application/x-mpegURL", src: "https://nukeops.com/media/protected/hls/{{ stream.title|urlencode }}.m3u8" }]
        });
    </script>
    {% else %}
    <p>You need to be logged in to watch this stream. <a href="{% url 'login' %}?next={{ request.path }}">Login</a></p>
    {% endif %}
    {% else %}
    <h2>Stream: {{ stream.title }}</h2>
    <video id="hlsPlayer" class="video-js vjs-default-skin" controls width="640" height="360">
        <source src="https://nukeops.com/media/protected/hls/{{ stream.title|urlencode }}.m3u8"
            type="application/x-mpegURL">
        Your browser does not support the video tag.
    </video>
    <script>
        var player = videojs('hlsPlayer', {
            techOrder: ['html5'],
            sources: [{ type: "application/x-mpegURL", src: "https://nukeops.com/media/protected/hls/{{ stream.title|urlencode }}.m3u8" }]
        });
    </script>
    {% endif %}
</body>

</html>